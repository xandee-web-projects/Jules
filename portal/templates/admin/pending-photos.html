{% extends 'bases/base_admin.html' %}
{% block title %}Pending photos{% endblock %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
<div class="container-fluid py-4">
	<div class="row">
		<div class="col-12">
			<div class="card my-4">
				<div class="card-header pb-0 p-3"></div>
				<div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
					<div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
						<div class="row">
							<div class="col-6 d-flex align-items-center">
								<h6 class="text-white text-capitalize ps-3">Pending photos</h6>
							</div>
						</div>
					</div>
				</div>
				<div class="card-body px-0 pb-2">
					<div class="table-responsive p-0">
						<table class="table align-items-center mb-0">
							<thead>
								<tr>
									<th class="text-left text-uppercase text-secondary text-xs font-weight-bolder opacity-7">
										ID
									</th>
									<th class="text-uppercase text-secondary text-xs font-weight-bolder opacity-7">
										Photo
									</th>
								</tr>
							</thead>
							<tbody>
								{% for p in photos %}
								<tr>
									<td class="align-middle text-center  text-sm">
										<span>{{p._id}}</span>
									</td>
									<td>
										<div class="d-flex">
											<img
												src="{{ url_for('views.get_photo', filename=p.photo %}"
												class="border-radius-lg"
												alt="photo"
												style="width: 200px; height: auto;"
											/>
										</div>
									</td>
									<td class="align-middle">
										<a onclick="delete_request({{p._id}})"
										type="button"
										class="text-secondary font-weight-bold text-xs"><i class="material-icons opacity-10">delete</i>
									</a>
									</td>
									<td class="align-middle">
										<a onclick="approve_request({{p._id}})"
										type="button"
										class="text-secondary font-weight-bold text-xs"><i class="material-icons opacity-10">check</i>
									</a>
									</td>
								</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script>
function delete_request(_id){
	fetch("/a/discard-photo", {
		method: "POST",
		body: JSON.stringify({ id: _id }),
	}).then((res) => {
		window.location.href = "{{ url_for('admin.pending_photos' %}";
	});
}
function approve_request(_id){
	fetch("/a/approve-photo", {
		method: "POST",
		body: JSON.stringify({ id: _id }),
	}).then((res) => {
		window.location.href = "{{ url_for('admin.pending_photos' %}";
	});
}
</script>
{% endblock %}
